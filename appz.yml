app:
    name: ClickHouseCluster
    code: clickhousecluster
    notify: anand@maximaconsulting.com

build:
    version: 25.6
    env: DEV
    build_file: none
    output_files: output/*.zip
    image_template: clickhousecluster-25.6

deploy:
    context: anandp0/DEV
    type: statefulset
    replicas: 3
    resources: x-large
    port:
    - 8123
    - 9000
    - 9363

volumes:
  - claim: clickhouse-data
    class: linode-block-storage
    mount: /appz/data
    name: data
    size: 200Gi
    matchLabels: false

properties:
    CLICKHOUSE_NODES: 0@clickhousecluster-25-6-0.clickhousecluster-25-6.vv-prod.svc.cluster.local:9000,1@clickhousecluster-25-6-1.clickhousecluster-25-6.vv-prod.svc.cluster.local:9000
    CLICKHOUSE_CLUSTER_NAME: clickhousecluster
    CLICKHOUSE_USER: default
    CLICKHOUSE_PASSWORD:
        vault: CLICKHOUSE_PASSWORD

    KEEPER_NODES: clickhousecluster-25-6-0.clickhousecluster-25-6.vv-prod.svc.cluster.local:9181,clickhousecluster-25-6-1.clickhousecluster-25-6.vv-prod.svc.cluster.local:9181
    REPLICATION_FACTOR: 2
    SHARD_COUNT: 1
    ENABLE_FLUENTD: 1
    revision: 14
